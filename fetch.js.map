{"version":3,"file":"fetch.js","names":["assetsUrl","console","time","log","getCachedData","data","timeEnd","pagedGet","method","options","page","pageSize","aggregatedResponse","reviews","concat","length"],"sources":["src/fetch.js"],"sourcesContent":["import {\n  getCachedData\n} from \"./yotpo\";\n\nexport default async (assetsUrl) => {\n  console.time(`Fetch Yotpo reviews`);\n  console.log(`Starting to fetch reviews from Yotpo using AU's fork of gatsby-source-yotpo`);\n\n  const data = await getCachedData(assetsUrl);\n\n  console.timeEnd(`Fetch Yotpo reviews`);\n\n  return data;\n};\n\nasync function pagedGet(\n  method,\n  options,\n  page = 1,\n  pageSize = 1000,\n  aggregatedResponse = null\n) {\n  const reviews = await method({\n    ...options,\n    page,\n    pageSize,\n  });\n\n  if (!aggregatedResponse) {\n    aggregatedResponse = reviews;\n  } else {\n    aggregatedResponse = aggregatedResponse.concat(reviews);\n  }\n\n  if (reviews.length > 0) {\n    return pagedGet(method, options, page + 1, pageSize, aggregatedResponse);\n  }\n\n  return aggregatedResponse;\n}\n"],"mappings":";;;;;;;;;;AAAA;AAEiB;AAAA;AAAA;EAAA,yFAEF,iBAAOA,SAAS;IAAA;IAAA;MAAA;QAAA;UAAA;YAC7BC,OAAO,CAACC,IAAI,uBAAuB;YACnCD,OAAO,CAACE,GAAG,+EAA+E;YAAC;YAAA,OAExE,IAAAC,oBAAa,EAACJ,SAAS,CAAC;UAAA;YAArCK,IAAI;YAEVJ,OAAO,CAACK,OAAO,uBAAuB;YAAC,iCAEhCD,IAAI;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CACZ;EAAA;IAAA;EAAA;AAAA;AAAA;AAAA,SAEcE,QAAQ;EAAA;AAAA;AAAA;EAAA,0FAAvB,kBACEC,MAAM,EACNC,OAAO;IAAA;MAAA;MAAA;MAAA;MAAA;IAAA;MAAA;QAAA;UAAA;YACPC,IAAI,8DAAG,CAAC;YACRC,QAAQ,8DAAG,IAAI;YACfC,kBAAkB,8DAAG,IAAI;YAAA;YAAA,OAEHJ,MAAM,iCACvBC,OAAO;cACVC,IAAI,EAAJA,IAAI;cACJC,QAAQ,EAARA;YAAQ,GACR;UAAA;YAJIE,OAAO;YAMb,IAAI,CAACD,kBAAkB,EAAE;cACvBA,kBAAkB,GAAGC,OAAO;YAC9B,CAAC,MAAM;cACLD,kBAAkB,GAAGA,kBAAkB,CAACE,MAAM,CAACD,OAAO,CAAC;YACzD;YAAC,MAEGA,OAAO,CAACE,MAAM,GAAG,CAAC;cAAA;cAAA;YAAA;YAAA,kCACbR,QAAQ,CAACC,MAAM,EAAEC,OAAO,EAAEC,IAAI,GAAG,CAAC,EAAEC,QAAQ,EAAEC,kBAAkB,CAAC;UAAA;YAAA,kCAGnEA,kBAAkB;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAC1B;EAAA;AAAA"}